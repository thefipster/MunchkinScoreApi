language: csharp
mono: none
sudo: required
dist: xenial
dotnet: 2.2
env:
  global:
    CC_TEST_REPORTER_ID=0ba4bd607bc05a1af3e1affef396cd876af2df5fc9a672c4afdb4e9a6a7795cc
global:
  - DOTNET_SKIP_FIRST_TIME_EXPERIENCE=true
  - DOTNET_CLI_TELEMETRY_OPTOUT=1
before_script:
  - dotnet tool install -g dotnet-reportgenerator-globaltool
  - curl -L https://codeclimate.com/downloads/test-reporter/test-reporter-latest-linux-amd64 > ./cc-test-reporter
  - chmod +x ./cc-test-reporter
  - ./cc-test-reporter before-build
script:
  - dotnet restore
  - dotnet build
  - dotnet test --filter FullyQualifiedName~UnitTest /p:CollectCoverage=true /p:CoverletOutputFormat=cobertura /p:Exclude=[xunit*]*
  - ~/.dotnet/tools/reportgenerator "-reports:**\coverage.cobertura.xml" "-targetdir:." -reporttypes:Cobertura
  - ./cc-test-reporter format-coverage --input-type cobertura Cobertura.xml
  - ./cc-test-reporter upload-coverage
after_script:
  - ./cc-test-reporter after-build --exit-code $TRAVIS_TEST_RESULT